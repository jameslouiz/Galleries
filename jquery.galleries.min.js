/*!
 * Galleries - v0.0.4
 *
 * Simple, elegant image gallery plugin to load external images and insert them into the markup
 *
 * By James Thomoson - @jameslouiz
 *    james.tommo@yahoo.co.uk
 *    http://jameslouiz.com
 *
 */(function(t){t.bind=function(e,a){var n=Array.prototype.slice.call(arguments,2);return function(){var l=[this].concat(n,t.makeArray(arguments));return a.apply(e,l)}};var e=function(t,e){this.init(t,e)};e.Defaults={className:"",preloader:!1,delay:0,callbacks:{onInit:null,beforeLoad:null,afterLoad:null}},e.prototype={init:function(a,n){this.$element=t(a),this.options=t.extend({},e.Defaults,n),"object"!=typeof window.galleryStack&&(window.galleryStack=t([])),this.$element.addClass("unloaded"),this.stack=window.galleryStack,this.target=t("#preview"),this.src=this.$element.attr("href"),this.callHook("onInit")},callHook:function(t){"function"==typeof this.options.callbacks[t]&&this.options.callbacks[t]()},showPreload:function(){this.options.preloader&&this.target.find(this.preloader).fadeIn(200)},hidePreload:function(){this.options.preloader&&this.target.find(this.preloader).fadeOut(200)},get:function(){if(this.src!=this.target.find("img").attr("src")){var t=this.checkStack(this.src),e=this.pullStack(this.src),e=e[0];t?this.set(e):this.load(this.src)}},save:function(t,e){var a=this.checkStack(e);a||window.galleryStack.push(t)},pullStack:function(e){var a=t.grep(window.galleryStack,function(t){return t.getAttribute("src")==e});return a},checkStack:function(t){var e=this.pullStack(t);return e.length?!0:!1},load:function(t){var e=new Image,a=this;this.callHook("beforeLoad"),this.showPreload(),e.onload=function(){setTimeout(function(){a.set(e),a.hidePreload(),a.save(e,t),a.callHook("afterLoad"),a.$element.removeClass("unloaded").addClass("loaded")},a.delay)},e.src=t},set:function(t){this.target.html(t),this.callHook("onChange")}};var a=t.fn.gallery;t.fn.gallery=function(a){return this.each(function(){var n=t(this),l=n.data("jl.gallery"),o="object"==typeof a&&a;l||n.data("jl.gallery",l=new e(this,o)),"get"==a&&l.get()})},t.fn.gallery.Constructor=e,t.fn.gallery.noConflict=function(){return t.fn.gallery=a,this},t(document).on("click","[data-stage]",function(e){t(this).gallery("get"),e.preventDefault()})})(jQuery);